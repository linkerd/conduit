#!/bin/sh

set -eu

os=linux
exe=
if [ "$(uname -s)" = "Darwin" ]; then
  os=darwin
elif [ "$(uname -o)" = "Msys" ]; then
  os=windows
  exe=.exe
fi

bin=go/target/${os}_amd64_cgo/conduit

# build conduit executable if it does not exist
if [ ! -f $bin ]; then
  OS=$os bin/build-cli-bin >/dev/null
fi

exec $bin "$@"
